{% extends 'base.html' %}
{% load static %}
{% load i18n %}

{% block css %}
<link href="{% static 'main/css/statistics.css' %} " rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
<title>Statistics</title>
{% endblock%}

{% block content %}
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-12 col-md-10 col-lg-8">
            <div class="card shadow-lg inform">
                <h2 class="card-title text-center">{% trans "Primary Disability" %}</h2> <!-- Spațiu mai mare sub titlu -->
                <div class="card-body p-4">
                    <p class="card-text text-justify">
                        {% trans "The number of individuals recognized for the first time with a disability has increased compared to the previous year. According to data from the National Council for the Determination of Disability and Work Capacity, in 2023, 14.3 thousand people applied for evaluation. Of these, 12.9 thousand people (90.5%) were recognized with a primary disability, including 11.2 thousand adults (86.9%) and 1.6 thousand children (13.1%). The proportion of people with a primary disability was higher in rural areas, accounting for 63.3% in 2023." %}
                    </p>
                </div>
            </div>
        </div>

        <!-- Cardul cu graficul -->
        <div class="col-12 col-md-10 col-lg-8 mt-5"> <!-- Spațiu mare între cele 2 carduri -->
            <div class="card shadow-lg">
                <div class="card-body p-4">
                    <canvas id="Chart_1" class="w-100"></canvas>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block javascript %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    const statistics = {{ statistics|safe }};

    window.onload = function() {
      const ctx = document.getElementById('Chart_1');

      function get_year() {
        let years = [];
        for (let i = 0; i < statistics.length; i++) {
          years.push(statistics[i].year);
        }
        return years;
      }

      function get_number()
      {
          let numbers = new Array();
            for (let i = 0; i < statistics.length; i++) {
          numbers.push(statistics[i].number_of_people);
        }
        return numbers;

      }

      const years = get_year();
      const number_of_peoples = get_number();
      new Chart(ctx, {
    type: 'bar',
    data: {
      labels: years,
      datasets: [{
        label: 'Number of People with Primary Disability (in thousands)',
        data: number_of_peoples,
        backgroundColor: 'rgba(153, 102, 255, 0.6)',       // пастельно-фиолетовый фон
        borderColor: 'rgba(153, 102, 255, 1)',
        borderWidth: 1,
        hoverBackgroundColor: 'rgba(153, 102, 255, 0.8)',
        hoverBorderColor: 'rgba(153, 102, 255, 1)',
      }]
    },
    options: {
      responsive: true,
      plugins: {
        legend: {
          position: 'top',
          labels: {
            font: { size: 14 }
          }
        },
        tooltip: {
          backgroundColor: 'rgba(0, 0, 0, 0.7)',
          titleColor: 'white',
          bodyColor: 'white',
          bodyFont: { size: 14 }
        }
      },
      scales: {
        x: {
          title: {
            display: true,
            text: 'Year',
            font: { size: 16 }
          }
        },
        y: {
          beginAtZero: true,
          title: {
            display: true,
            text: 'Number of People (in thousands)',
            font: { size: 16 }
          }
        }
      }
    }
  });


    }
</script>
{% endblock %}
